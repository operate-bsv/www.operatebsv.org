(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{615:function(t,s,e){"use strict";e.r(s);var a=e(41),n=Object(a.a)({},(function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("p",[t._v("One of the most common use cases for Operate is being able to map data encapsulated in Bitcoin transactions in to structured objects.")]),t._v(" "),e("p",[t._v("Until now, Unwriter's "),e("a",{attrs:{href:"https://bitcom.planaria.network/",target:"_blank",rel:"noopener"}},[t._v("Bitcom"),e("OutboundLink")],1),t._v(' has been the "go-to" approach of encapsulating data on-chain - either using app-specific protocols like '),e("a",{attrs:{href:"https://weathersv.app/docs",target:"_blank",rel:"noopener"}},[t._v("WeatherSV"),e("OutboundLink")],1),t._v(", or building upon generic data protocols such as "),e("a",{attrs:{href:"https://b.bitdb.network/",target:"_blank",rel:"noopener"}},[e("code",[t._v("B://")]),e("OutboundLink")],1),t._v(" and "),e("a",{attrs:{href:"https://map.sv/",target:"_blank",rel:"noopener"}},[e("code",[t._v("MAP")]),e("OutboundLink")],1),t._v(".")]),t._v(" "),e("p",[t._v("A Bitcom protocol only gets us so far. It describes how the data is encapsulated, but developers still have to implement that protocol. This leads to a repetition of efforts but also some ambiguity as implementations will inevitably diverge slightly from app to app which hinders interoperability.")]),t._v(" "),e("p",[t._v('Operate fixes this by replacing protocols with functions, known as "Ops", which themselves are stored on the blockchain. This means we could have 1,000 different "file" or "user profile" Ops, and Operate would always return the data structured how the transaction author intended, without an application developer needing to write a single line of code.')]),t._v(" "),e("h2",{attrs:{id:"example-on-chain-business-directory"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#example-on-chain-business-directory"}},[t._v("#")]),t._v(" Example: On-chain business directory")]),t._v(" "),e("p",[t._v("Imagine you're building a business directory and would like to encapsulate a listing using a data structure similar to below (based on the "),e("a",{attrs:{href:"https://schema.org/Organization",target:"_blank",rel:"noopener"}},[t._v("Schema.org Organization"),e("OutboundLink")],1),t._v(" schema):")]),t._v(" "),e("div",{staticClass:"language-json extra-class"},[e("pre",{pre:!0,attrs:{class:"language-json"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"@type"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Organization"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"name"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Acme Ltd"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"address"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"@type"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"PostalAddress"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"streetAddress"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"10 Downing Street"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"addressLocality"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"London"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"postalCode"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"SW1A 2AA"')]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"contacts"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"@type"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ContactPoint"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"telephone"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"0800 123 456"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"contactType"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Customer service"')]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"@type"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ContactPoint"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"telephone"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"0800 100 200"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"contactType"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Sales"')]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("p",[t._v("It's tempting to just serialize the JSON data into a single string, but then you'd lose the benefit of being able to index the data and query by specific attributes using a tool such as "),e("a",{attrs:{href:"https://docs.planaria.network/",target:"_blank",rel:"noopener"}},[t._v("Planaria"),e("OutboundLink")],1),t._v(". Operate can do better and already boasts a number of incredibly flexible and powerful Ops that can be used to map any data structure imaginable. In this example we'll use just two:")]),t._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"/library/op/?ref=2432924b"}},[e("code",[t._v("object/extend")])]),t._v(" - takes a list of parameters in key/value pairs and merges them into the state.")]),t._v(" "),e("li",[e("a",{attrs:{href:"/library/op/?ref=d0138187"}},[e("code",[t._v("object/put")])]),t._v(" - is very similar to "),e("code",[t._v("object/extend")]),t._v(" but takes an initial "),e("code",[t._v("path")]),t._v(" parameter and the key/values are placed in the state at the given path.")])]),t._v(" "),e("p",[t._v("Both of the above Ops have a trick up their sleeve. Dot delimited keys (eg: "),e("code",[t._v("deeply.nested.path")]),t._v(") are iterated over setting the value in a deeply nested object. Additionally, if a key ends with square brackets (eg: "),e("code",[t._v("mylist[]")]),t._v(" ), the value is pushed into an array.")]),t._v(" "),e("h3",{attrs:{id:"constructing-the-transaction"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#constructing-the-transaction"}},[t._v("#")]),t._v(" Constructing the transaction")]),t._v(" "),e("p",[t._v("Lets begin constructing an "),e("code",[t._v("OP_RETURN")]),t._v(" script starting off using "),e("code",[t._v("object/extend")]),t._v(":")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[t._v("OP_FALSE OP_RETURN\n  0x2432924B  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# object/extend")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"@type"')]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Organization"')]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"name"')]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Acme Ltd"')]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ...")]),t._v("\n")])])]),e("p",[t._v("So far so simple. The Op parameters are key/value pairs, where each odd parameter is a key and each even parameter is its respective value.")]),t._v(" "),e("p",[t._v("But now we need to tackle a nested object. You could carry on defining key/value pairs using the dot-delimited syntax. Eg:")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[t._v("    "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ...")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"address.@type"')]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"PostalAddress"')]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"address.streetAddress"')]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"10 Downing Street"')]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ...")]),t._v("\n")])])]),e("p",[t._v("But it's possible to save a few bytes (and is arguably more semantically pleasing) if we pipe the state into a new Op, using "),e("code",[t._v("object/put")]),t._v(":")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[t._v("    "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ...")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n  0xD0138187  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# object/put")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"address"')]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"@type"')]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"PostalAddress"')]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"streetAddress"')]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"10 Downing Street"')]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"addressLocality"')]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"London"')]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"postalCode"')]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"SW1A 2AA"')]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ...")]),t._v("\n")])])]),e("p",[t._v("The first Op parameter is the path where we intend to place the object, and the remaining parameters are the key/value pairs of that object.")]),t._v(" "),e("p",[t._v("Finally, by using "),e("code",[t._v("object/put")]),t._v(" in combination with the square bracket syntax, you can add the list of contact points to the data structure. Setting the path as "),e("code",[t._v("contacts[]")]),t._v(" denotes that the key/value pairs will be pushed into an array at that path.")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[t._v("    "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ...")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n  0xD0138187  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# object/put")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"contacts[]"')]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"@type"')]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ContactPoint"')]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"telephone"')]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"0800 123 456"')]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"contactType"')]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Customer service"')]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n  0xD0138187  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# object/put")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"contacts[]"')]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"@type"')]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ContactPoint"')]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"telephone"')]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"0800 100 200"')]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"contactType"')]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Sales"')]),t._v("\n")])])]),e("h3",{attrs:{id:"putting-it-all-together"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#putting-it-all-together"}},[t._v("#")]),t._v(" Putting it all together")]),t._v(" "),e("p",[t._v("The entire "),e("code",[t._v("OP_RETURN")]),t._v(" script looks like this (reformatted slightly for clarity):")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[t._v("OP_FALSE OP_RETURN\n  0x2432924B  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# object/extend")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"@type"')]),t._v("           "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Organization"')]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"name"')]),t._v("            "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Acme Ltd"')]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n  0xD0138187  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# object/put")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"address"')]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"@type"')]),t._v("           "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"PostalAddress"')]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"streetAddress"')]),t._v("   "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"10 Downing Street"')]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"addressLocality"')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"London"')]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"postalCode"')]),t._v("      "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"SW1A 2AA"')]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n  0xD0138187  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# object/put")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"contacts[]"')]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"@type"')]),t._v("           "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ContactPoint"')]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"telephone"')]),t._v("       "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"0800 123 456"')]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"contactType"')]),t._v("     "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Customer service"')]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n  0xD0138187  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# object/put")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"contacts[]"')]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"@type"')]),t._v("           "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ContactPoint"')]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"telephone"')]),t._v("       "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"0800 100 200"')]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"contactType"')]),t._v("     "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Sales"')]),t._v("\n")])])]),e("p",[t._v("And as a hex script:")]),t._v(" "),e("pre",[e("code",{staticStyle:{"font-size":"0.75rem"}},[t._v("0 OP_RETURN 2432924b 4074797065 4f7267616e697a6174696f6e 6e616d65 41636d65204c7464 7c d0138187 61646472657373 4074797065 506f7374616c41646472657373 73747265657441646472657373 313020446f776e696e6720537472656574 616464726573734c6f63616c697479 4c6f6e646f6e 706f7374616c436f6465 5357314120324141 7c d0138187 636f6e74616374735b5d 4074797065 436f6e74616374506f696e74 74656c6570686f6e65 303830302031323320343536 636f6e7461637454797065 437573746f6d65722073657276696365 7c d0138187 636f6e74616374735b5d 4074797065 436f6e74616374506f696e74 74656c6570686f6e65 303830302031303020323030 636f6e7461637454797065 53616c6573")])]),t._v(" "),e("h2",{attrs:{id:"conclusion"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#conclusion"}},[t._v("#")]),t._v(" Conclusion")]),t._v(" "),e("p",[t._v("From this example you've been able to encapsulate a relatively complex data object - combining both nested objects and array-like structures - in a Bitcoin transaction. The data is encapsulated in a way that is both efficient and indexable and queryable using Planaria.")]),t._v(" "),e("p",[t._v("Operate now handles the rest. When you or anyone else loads and runs the transaction, Operate will return the structured object, without any application code needed to parse and decode the data.")]),t._v(" "),e("p",[t._v("But what if you wanted to verify the authenticity of the data with signatures? Or what if the data contained private information that needed to be encrypted? Well, Operate has got you covered there too... but that's an article for another day.")])])}),[],!1,null,null,null);s.default=n.exports}}]);